<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>로그인 - 근태ON</title>

    <!-- open graph -->
    <meta property="og:title" content="근태 ON">
    <meta property="og:url" content="https://gton.dothome.co.kr/attendance/">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://gton.dothome.co.kr/attendance/assets/og-image.png">
    <meta property="og:title" content="근태 ON">
    <meta property="og:description" content="스마트한 근태관리 시스템, 근태 ON">

    <!-- css -->
    <link rel="stylesheet" href="css/font.css">
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/login.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">

    <!-- SweetAlert2 Library -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>

<body>
    <div class="login-container">
        <div class="login-box">
            <div class="login-logo font-godo">
                <h1>근태ON</h1>
                <p>스마트한 근태관리 시스템</p>
            </div>

            <form id="loginForm" class="login-form" method="POST" autocomplete='off'>
                <div class="form-group">
                    <label class="form-label" for="username">아이디</label>
                    <input type="text" id="username" name="username" class="form-input" placeholder="아이디를 입력해주세요"
                        required>
                </div>

                <div class="form-group">
                    <label class="form-label" for="password">비밀번호</label>
                    <input type="password" id="password" name="password" class="form-input" placeholder="비밀번호를 입력해주세요"
                        required>
                </div>

                <div class="form-options">
                    <div class="remember">
                        <input type="checkbox" id="rememberMe" name="rememberMe">
                        <label for="rememberMe">아이디 저장</label>
                    </div>
                    <div class="find">
                        <a href="find_password.html">비밀번호 찾기</a>
                    </div>
                </div>

                <button type="submit" id="submitBtn" class="btn btn-primary btn-block">로그인</button>
            </form>

            <div class="login-footer">
                <p>계정이 없으신가요? <a href="signup.html">회원가입</a></p>
            </div>
        </div>
    </div>

    <script>
        document.querySelector('#loginForm').addEventListener('submit', function (e) {
            e.preventDefault();

            const submitBtn = document.getElementById('submitBtn');

            // 중복 클릭 방지 (UX 개선)
            submitBtn.disabled = true;
            submitBtn.innerText = "로그인 중...";

            const formData = new FormData(this);

            fetch('login_process.php', {
                method: 'POST',
                body: formData
            })
                .then(response => {
                    // PHP에서 에러가 발생했을 경우 처리
                    if (!response.ok) throw new Error('네트워크 응답에 문제가 있습니다.');
                    return response.json();
                })
                .then(data => {
                    if (data.success) {
                        Swal.fire({
                            icon: 'success',
                            title: '환영합니다!',
                            text: data.message,
                            timer: 1500,
                            showConfirmButton: false
                        }).then(() => {
                            location.href = 'dashboard.html';
                        });
                    } else {
                        Swal.fire({
                            icon: 'error',
                            title: '로그인 실패',
                            text: data.message,
                            confirmButtonColor: '#your-main-color' // CSS 변수 대신 실제 색상코드 권장
                        });
                        // 실패 시 버튼 다시 활성화
                        submitBtn.disabled = false;
                        submitBtn.innerText = "로그인";
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    Swal.fire('오류', '서버 통신 중 문제가 발생했습니다.', 'error');
                    submitBtn.disabled = false;
                    submitBtn.innerText = "로그인";
                });
        });
    </script>
</body>

</html>